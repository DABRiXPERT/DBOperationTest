{% extends 'base.html' %}

{% block title %}顯示資料{% endblock %}

{% block content %}
<!--
    <h1>資料顯示</h1>

    
    <form id="clear-form" action="{% url 'clear_data' %}" method="POST">
        {% csrf_token %}
        <button type="button" id="clear-data-btn" class="btn btn-clear">清除所有資料</button>
    </form>

    <div id="alert-dialog" class="modal">
        <div class="modal-content">
            <p>確定要清除所有資料嗎？此操作無法還原。</p>
            <button id="confirm-clear-btn" class="btn btn-danger">確認清除</button>
            <button id="cancel-clear-btn" class="btn btn-secondary">取消</button>
        </div>
    </div>

    <table id="data-table" class="data-table">
        <thead>
        <tr>
            <th>刪除</th>
            <th>月份 (YYYY-MM)</th>
            <th>參數A</th>
            <th>參數B</th>
            <th>參數C</th>
            <th>參數D</th>
            <th>參數E</th>
            <th>參數F</th>
            <th>參數G</th>
            <th>參數H</th>
        </tr>
        </thead>
        <tbody>
        {% for entry in entries %}
            <tr data-id="{{ entry.id }}">
                <td><button class="btn btn-delete-row">刪除</button></td>
                <td class="editable" data-field="unix_month">{{ entry.converted_date }}</td>
                <td class="editable" data-field="parameter_a">{{ entry.parameter_a }}</td>
                <td class="editable" data-field="parameter_b">{{ entry.parameter_b }}</td>
                <td class="editable" data-field="parameter_c">{{ entry.parameter_c }}</td>
                <td class="editable" data-field="parameter_d">{{ entry.parameter_d }}</td>
                <td class="editable" data-field="parameter_e">{{ entry.parameter_e }}</td>
                <td class="editable" data-field="parameter_f">{{ entry.parameter_f }}</td>
                <td class="editable" data-field="parameter_g">{{ entry.parameter_g }}</td>
                <td class="editable" data-field="parameter_h">{{ entry.parameter_h }}</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
-->

<div id="charts-container"></div>

<script>
    // 從Django後端獲取傳遞到前端的數據
    var labels = {{ labels|safe }};  // X軸標籤 (converted_date)
    var data = {{ data|safe }};      // 多維數組 (參數資料)

    // 參數名稱，與 data 對應
    var parameterNames = ['Parameter A', 'Parameter B', 'Parameter C', 'Parameter D', 'Parameter E', 'Parameter F', 'Parameter G', 'Parameter H'];

    // 動態生成圖表的容器
    var container = document.getElementById('charts-container');
    parameterNames.forEach(function(name, index) {
        // 為每個參數創建一個 div 來放置圖表
        var chartDiv = document.createElement('div');
        chartDiv.id = 'chart-' + index;
        chartDiv.style.marginBottom = '50px';  // 設定每個圖表之間的間距
        container.appendChild(chartDiv);

        // 配置ApexCharts圖表
        var options = {
            chart: {
                type: 'bar',
                height: 350
            },
            series: [{
                name: name,
                data: data[index]  // 對應的參數數據
            }],
            xaxis: {
                categories: labels  // X軸的 converted_date
            },
            title: {
                text: name + ' over Time',
                align: 'left'
            },
            yaxis: {
                title: {
                    text: name + ' Value'
                }
            }
        };

        // 為每個參數生成一個圖表
        var chart = new ApexCharts(document.querySelector('#chart-' + index), options);
        chart.render();
    });
</script>
{% endblock %}
